# 可话聊天记录导出的尝试

本项目旨在导出可话的聊天记录。

## 1. 具体原理
1. 首先在Mac上登陆ios版可话（问就是我只会用python在电脑上操作）
2. getChatRecord会对不停对可话进行翻页，然后对当前可话页面进行截屏
3. 截屏后，processImage对图片处理后调用OCR，可以获取聊天记录时间，聊天用户，以及聊天记录等信息。
4. 最后在getChatRecord中对信息进行汇总，存储在json文件中。为了避免翻页时遇到加载，以及一条消息正好卡在中间，导致识别的不准确，我们翻页的长度比实际页面的长度要小一些，并检查重复识别的消息。

## 2. 使用
1. 建立虚拟环境后，安装requirements.txt中的依赖性
2. 需要手动确定截屏区域的大小（修改region列表中的值），以及根据自己窗口的大小调整翻页的距离。
3. 终端输入python3 getChatRecord.py后，把光标放在可话的界面上，程序开始运行并自动保存。

## 3. 思考
1. 由于可话的聊天记录都存储在本地，一开始希望直接找到聊天记录对应的缓存文件，但是发现有些缓存文件使用的是明文，但是有些无法用utf-8进行提取，因此这个想法作罢；
2. 在进行OCR识别时，识别率较低。同时截屏的时候，得到图片的分辨率也很低。不知道能不能通过CNN的模型进行更准确的识别。同时表情完全无法识别。
3. 不知道有没有迁移到手机上进行提取的方法。电脑上的聊天记录不全。目前代码也只是初步完成，bug比较多，也不是很完善。
4. 之后希望根据时间的不同，做一个随时间变化的动态词云图。具体怎么实现还在构思中。
5. 由于本人只是一个普普通通的非计算机专业本科生，想到导出可话聊天记录只是出于自己的兴趣和好奇，因此难免方法会显得幼稚和漏洞百出，也请看到的人能提供好的想法和建议，感激不尽。
