今天收到可话的一封信，发现可话终于还是要停止运营了，于是赶紧在AI的帮助下，准备把聊天记录导出。

首先询问了官方，得到的答复是，数据存储在云端，是不能导出的。但实际上如果你断网使用可话就会发现，数据是存储在本地的，因此也给了我们导出聊天记录的空间。不过我对APP这些也不是很了解，因此借助AI帮我导出了，最终成果如图所示，支持查找关键词以及特定日期查询。

具体思路是：

1. 首先我们需要访问用户数据，但是/data/data是访问不了的，因此先通过备份和传输（我是小米手机），将可话的数据备份下来（在设置中找到“备份和传输”，在“第三方应用”中下拉菜单找到可话）

2. 备份得到的数据是.bak格式，是没办法直接解压缩的，这个最好问一下AI怎么做。小米会在压缩包前加上新的文件头，因此先用extract_ab.py去除后，然后用unpack_ab.py对生成的.ab文件进行解压。

3. 接下来我下载了DB Browser for SQLite来处理里面的数据库文件。找到其中的./apps/com.app.tideswing/db/TideSwing.db文件后，导入到DB Browser for SQLite中，点击Browser Data，查找其中名为t_chat_msg的项，就是存储在本地的聊天记录。从DB Browser for SQLite中导出这个表格（格式为kson），使用data_processing.py预处理一下文件后（因为所有人的聊天记录是混在一起存储的，因此要把你希望提取的那个人的聊天记录提取出来，方便在前端显示），存储为json文件。然后在浏览器打开viewer.html，将这个处理后的文件加载进去，就能浏览聊天记录了。

4. 由于我中途换过手机，因此本地的聊天记录是不全的，目前在使用连点器，不停在聊天界面刷新，看能不能把之前的聊天记录加载回来。

这些工作都是AI完成的。一年前我也尝试过导出可话聊天记录，之前就猜想可话的聊天数据就在本地而且没有加密，但是gpt-4o根本给不出一个解决方案，最后我使用截屏加OCR，自然效果非常差，感谢AI让我能在北京周五的雪落下之前，将这些宝贵的回忆，藏在自己的树洞里。
